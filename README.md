<h1>Wazuh Endpoint Vulnerability & Slack Alerts Configuration </h1>
<br />

<h2>Languages and Utilities Used</h2>

- JSON

<h2>Environments Used </h2>

- <b>Wazuh</b> 4.7
- <b>Slack</b>
- <b>Slack</b> API

<h2>Program walk-through:</h2>

<h3>Enabling Vulnerability Scanning Feature</h3>

Navigate to "Management" and then "Configuration" section.

<img src="https://i.imgur.com/RTFMtho.png" height="80%" width="80%" alt="Image"/>
<br />
<br />

Open the management configuration by clicking on "Edit configuration".

<img src="https://i.imgur.com/ky8cE5m.png" height="80%" width="80%" alt="Image"/>
<br />
<br />

Search by "vulnerability-detector", then configure as follow:

```diff
<vulnerability-detector>
    <enabled>yes</enabled>
    <interval>5m</interval>
    <min_full_scan_interval>1h</min_full_scan_interval>
    <run_on_start>yes</run_on_start>

```

Then, save the new configuration and restart the manager.

<img src="https://i.imgur.com/rK0NGrF.png" height="80%" width="80%" alt="Image"/>
<br />
<br />

<h3>Enabling Alerts on Slack</h3>

Create a new channel or use an existing one. Give it a proper name.

<img src="https://i.imgur.com/S5m6cki.png" height="80%" width="80%" alt="Image"/>
<br />
<br />

Navigate to Slack API website at www.api.slack.com
Login if needed > go to "Your Apps" > Create New App.

<img src="https://i.imgur.com/BbhtJyd.png" height="80%" width="80%" alt="Image"/>
<br />

<img src="https://i.imgur.com/yN7klEO.png" height="80%" width="80%" alt="Image"/>
<br />
<br />

Give a name to the app, then choose the workspace where the app should be developed in.
Once the app is created, in the app configuration page click and navigate to "Incoming Webhooks.

<img src="https://i.imgur.com/626rXrl.png" height="80%" width="80%" alt="Image"/>
<br />
<br />

Turn the app on, then click on "Add New Webhook to Workspace".
Select the channel previously created and allow the connection.

<img src="https://i.imgur.com/qTCizZ1.png" height="80%" width="80%" alt="Image"/>
<br />
<br />

Scroll down and copy the Webhook URL.

<img src="https://i.imgur.com/f6iLHfx.png" height="80%" width="80%" alt="Image"/>
<br />
<br />

Navigate back to Wazuh configuration page, then edit configuration. Add the following configuration under \<global>...\</global> and replace WEBHOOKURL with the URL genearated from the app.

```diff

<integration>
  <name>slack</name>
  <hook_url>WEBHOOK_URL</hook_url> <!-- Replace with your Slack hook URL -->
  <alert_format>json</alert_format>
</integration>

```

Also, configure to generate alerts based on specific Rule IDs as following to avoid generating every type of alerts. Save the configuration and restart the manager.

```diff

<integration>
  <name>slack</name>
  <hook_url>WEBHOOK_URL</hook_url> <!-- Replace with your Slack hook URL -->
  <alert_format>json</alert_format>
  <rule_id>60122</rule_id>  <!-- Logon failure - Unknown user or bad password. Level 5 -->
  <rule_id>60204</rule_id>  <!-- Multiple Windows logon failures. Level 10 -->
</integration>

```

<br />
<br />
<br />


<a href="https://github.com/georgecyberli/WazuhSIEMproject" class="button icon back">Previous Page</a>

